name: ğŸš€ Build and Release Pipeline

on:
  push:
    branches: [dev, main]
    tags: ["v*"]
  workflow_dispatch:
  repository_dispatch:
    types: [build-trigger]

permissions:
  contents: write
  actions: read
  packages: write

jobs:
  build:
    name: ğŸ”¨ Build Application
    uses: ./.github/workflows/build.yml
    secrets: inherit

  release:
    name: ğŸš€ Create Release
    needs: build
    uses: ./.github/workflows/release.yml
    secrets: inherit
    if: |
      github.ref == 'refs/heads/main' || 
      github.ref == 'refs/heads/dev' || 
      startsWith(github.ref, 'refs/tags/') || 
      github.event_name == 'repository_dispatch'
